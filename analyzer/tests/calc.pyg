#!/usr/bin/env python

import tpg

def make_op(op):
	return
	{
		'+': lambda x,y: x+y,
		'-': lambda x,y: x-y,
		'*': lambda x,y: x*y,
		'/': lambda x,y: x/y,
	}[op]

class Calc(tpg.Parser):
	r"""

	separator spaces:	'\s+' ;

	token number:		'\d+'	int ;
	token add:			'[+-]'	make_op ;
	token mul:			'[*/]'	make_op ;

	START/e -> Expr/e ;
	Expr/e -> Term/e ( add/op term/t $ e=op(e,t) $ )* ;
	Term/t -> Fact/t ( mul/op Fact/f $ t=op(t,f) $ )* ;
	Fact/f -> Atom/f ;
	Atom/a -> number/a | '\(' Term/a '\)' ;

	"""

calc = Calc()
expr = raw_input('Enter an expression: ')
print expr, '=', calc(expr)
